# 37. Service Cluster IP.md

## Draft

* fe<>be<>db,cache는 서로 어떻게 커뮤니케이션하면 좋나?
* 알다시피 팟은 일시적이라 해당 팟의 아이피에는 의존못한다
* 이때 서비스 등장
* 각 팟들의 그룹핑을 하고, 각 그룹의 입구 역할을 통해 다른 그룹들은 해당 서비스와의 커뮤니케이션만을 통해 인터널 커뮤니케이션을 달성할수 있다
* 즉 싱글 인터페이스를 제공. 다른 팟들이 접근하고 커뮤니케이팅할수있는.
* 이를 통해 각 팟들은 신경안쓰구 스케일링등이 가능해져 , msa등에서도 대활약 가능
* 이 서비스를 클러스터 ip라 칭함
* how to create?
    * 4 common fields
    * spec.type = clusterip (default)
    * spec.ports = targetport, port
    * spec.selector to link pods


## TL;DR

**Kubernetes Service Cluster IP란?**

클러스터 IP는 쿠버네티스 서비스에서 사용되는 개념입니다. 이는 쿠버네티스 클러스터 내에서 서비스를 식별하고 접근하는 데 사용되는 IP 주소입니다.

클러스터 IP는 쿠버네티스 서비스를 통해 그룹화된 파드 집합에 대한 단일 접근 포인트를 제공합니다. 이 IP 주소는 정적이며, 서비스의 수명 동안 변경되지 않습니다. 이는 파드의 IP 주소가 동적이고 불안정한 것과 대조적입니다.

클러스터 IP를 사용하면, 다른 파드 또는 서비스가 해당 서비스에 접근할 수 있습니다. 이는 서비스 간의 통신을 단순화하고, 파드가 다운되거나 새로운 파드가 생성되더라도 통신을 유지할 수 있게 합니다.

클러스터 IP는 서비스 정의 파일을 통해 생성되며, 쿠버네티스 클러스터 내에서 유일합니다. 이 IP 주소 또는 할당된 서비스 이름은 다른 파드가 서비스에 접근하는 데 사용됩니다.

**서비스 작성 방법**

클러스터 IP 서비스를 만들려면 Kubernetes 서비스 정의 파일을 사용합니다.
파일에는 API 버전, 종류, 메타데이터 및 스펙을 지정하여 서비스를 정의합니다.
스펙 유형은 기본적으로 클러스터 IP로 설정됩니다.

## Summary from GPT3.5

👨‍🏫 **Kubernetes 클러스터 IP 서비스**

- **강의 내용**
  - 웹 애플리케이션은 다양한 종류의 파드를 가질 수 있음.
  - 프런트엔드 웹 서버, 백엔드 서버, Redis와 같은 키-값 스토어, MySQL과 같은 영구 데이터베이스가 될 수 있음.
  - 파드 간에 연결성을 확립하는 올바른 방법은?
  - 파드에는 IP 주소가 할당되지만 이는 정적이지 않음.
  - 쿠버네티스 서비스는 파드를 그룹화하고 이를 한 그룹으로 액세스할 수 있는 단일 인터페이스를 제공함.

- **중요한 포인트**
  - 서비스는 클러스터 내에서 IP와 이름을 할당받음.
  - 이것이 바로 클러스터 IP 서비스.
  - 서비스를 만들 때는 API 버전, 종류, 메타데이터 및 스펙을 포함한 정의 파일을 사용.

## Summary from copilot

이 강의에서는 쿠버네티스의 서비스 클러스터 IP에 대해 다루었습니다. 주요 내용은 다음과 같습니다:

- 🌐 쿠버네티스에서 전체 스택 웹 애플리케이션은 다양한 파드에서 호스팅됩니다. 이러한 파드는 프론트엔드, 백엔드, 키-값 저장소(Redis), 영구 데이터베이스(MySQL) 등을 실행할 수 있습니다.

- 🔄 이러한 서비스 간에는 통신이 필요하며, 파드의 IP 주소는 정적이지 않기 때문에 내부 통신에 의존할 수 없습니다.

- 🎯 쿠버네티스 서비스는 파드를 그룹화하고, 그룹 내의 파드에 접근하기 위한 단일 인터페이스를 제공합니다. 이를 통해 마이크로서비스 기반 애플리케이션을 쉽게 배포하고 확장할 수 있습니다.

- 🌐 각 서비스는 클러스터 내에서 IP와 이름이 할당되며, 이를 클러스터 IP라고 합니다. 이 이름은 다른 파드가 서비스에 접근하는 데 사용됩니다.

- 📝 서비스를 생성하려면 정의 파일을 사용하며, 이 파일에는 API 버전, 종류, 메타데이터, 명세 등의 정보가 포함됩니다. 

- 🌐 서비스는 클러스터 IP 또는 서비스 이름을 사용하여 다른 파드에 의해 접근될 수 있습니다.

## Script from GPT3.5

🎓 **Kubernetes 서비스 클러스터 IP**

- **웹 응용 프로그램 스택**
  - 전체 스택 웹 응용 프로그램에는 일반적으로 다양한 종류의 파드가 포함됩니다.
  - 프런트 엔드 웹 서버를 실행하는 여러 파드가 있을 수 있습니다.
  - 백엔드 서버를 실행하는 다른 세트의 파드,
  - Redis와 같은 키-값 저장소를 실행하는 세트,
  - MySQL과 같은 영구 데이터베이스를 실행하는 다른 세트의 파드가 있을 수 있습니다.

- **서비스 간 연결성**
  - 웹 프런트 엔드 서버는 백엔드 서버에 통신해야 하고,
  - 백엔드 서버는 데이터베이스 및 Redis 서비스에 통신해야 합니다.
  - 이러한 서비스 또는 응용 프로그램의 계층 간의 연결성을 수립하는 올바른 방법은 무엇인가요?

- **Kubernetes 서비스**
  - Kubernetes 서비스는 파드를 그룹화하고 해당 그룹의 파드에 액세스하는 단일 인터페이스를 제공할 수 있습니다.
  - 예를 들어, 백엔드 파드를 위해 생성된 서비스는 모든 백엔드 파드를 그룹화하고 다른 파드가 이 서비스에 액세스할 수 있는 단일 인터페이스를 제공합니다.

- **클러스터 IP 서비스**
  - 각 서비스에는 클러스터 내에서 할당된 IP와 이름이 지정됩니다.
  - 이 서비스는 클러스터 IP로 알려져 있습니다.

- **서비스 생성**
  - 서비스를 만들려면 일반적으로 서비스 정의 파일을 사용합니다.
  - 기본 템플릿을 사용하여 서비스를 정의합니다.
  - API 버전은 V1, 종류는 서비스이며, 메타데이터 및 스펙을 지정합니다.
  - 유형은 클러스터 IP로 설정하고, 포트는 백엔드가 노출된 포트와 서비스가 노출된 포트를 지정합니다.

- **서비스 액세스**
  - 생성된 서비스는 클러스터 IP 또는 서비스 이름을 사용하여 다른 파드에서 액세스할 수 있습니다.

## Script from Copilot

이 강의에서는 쿠버네티스 서비스 클러스터 IP에 대해 논의하겠습니다.

[ Service Cluster IP가 필요한 배경 ]

- 전체 스택 웹 애플리케이션은 일반적으로 애플리케이션의 다른 부분을 호스팅하는 다양한 종류의 파드를 가지고 있습니다. 🌐
- 프론트엔드 웹 서버를 실행하는 여러 파드, 백엔드 서버를 실행하는 다른 파드 세트, Redis와 같은 키-값 저장소를 실행하는 파드 세트, MySQL과 같은 영구 데이터베이스를 실행하는 다른 파드 세트가 있을 수 있습니다. 📦
- 웹 프론트엔드 서버는 백엔드 서버와 통신해야 하며, 백엔드 서버는 데이터베이스 및 Redis 서비스 등과 통신해야 합니다. 🔄
- 그렇다면 이러한 서비스 또는 애플리케이션의 계층 간 연결을 설정하는 올바른 방법은 무엇일까요? 🤔
- 모든 파드에는 IP 주소가 할당되어 있지만, 이 IP 주소는 정적이지 않습니다. 📑
- 이 파드는 언제든지 다운될 수 있고, 새로운 파드는 항상 생성되므로, 이 IP 주소를 애플리케이션 간의 내부 통신에 의존할 수 없습니다. ❌

- 쿠버네티스 서비스는 파드를 함께 그룹화하고, 그룹 내의 파드에 접근하기 위한 단일 인터페이스를 제공하는 데 도움이 될 수 있습니다. 🎯
- 백엔드 파드를 위해 생성된 서비스는 모든 백엔드 파드를 함께 그룹화하고, 다른 파드가 이 서비스에 접근하기 위한 단일 인터페이스를 제공하는 데 도움이 됩니다. 🎯
- 요청은 서비스 아래의 파드 중 하나로 무작위로 전달됩니다. 🔄
- 마찬가지로, Redis를 위한 추가 서비스를 생성하고, 백엔드 파드가 서비스를 통해 Redis 시스템에 접근하도록 허용합니다. 🎯
- 이를 통해 우리는 쿠버네티스 클러스터에서 마이크로서비스 기반 애플리케이션을 쉽고 효과적으로 배포할 수 있습니다. 🚀

- 각 계층은 이제 필요에 따라 확장하거나 이동할 수 있으며, 이는 다양한 서비스 간의 통신에 영향을 미치지 않습니다. 🔄
- **각 서비스는 클러스터 내에서 IP와 이름이 할당되며**, 이 이름은 다른 파드가 서비스에 접근하는 데 사용해야 하는 이름입니다. 📑
- 이러한 유형의 서비스를 클러스터 IP라고 합니다. 🌐

[ Service Cluster IP 작성 방법 ]

- 이러한 서비스를 생성하려면 항상 정의 파일을 사용합니다. 서비스 정의 파일에서는 먼저 기본 템플릿을 사용합니다. 📝
- API 버전은 V1, Kind는 서비스이며, 우리의 서비스에 이름을 줄 것입니다. 우리는 그것을 백엔드라고 부를 것입니다. 📝
- Spec에는 type과 port가 있습니다. 유형은 클러스터 IP입니다. 사실, 클러스터 IP는 기본 유형이므로, 심지어 지정하지 않아도 자동으로 유형을 클러스터 IP로 가정합니다. 📝
- port에는 target port와 port가 있습니다. 타겟 포트는 백엔드가 노출되는 포트이며, 이 경우는 80이며, 포트는 서비스가 노출되는 곳이며, 이것도 80입니다. 📝
- 서비스를 pod sets에 연결하기 위해 selector를 사용합니다. 우리는 파드 정의 파일을 참조하고 그것에서 레이블을 복사하고, 선택자 아래에 이동하면 됩니다. 그것이 전부입니다. 📝
- 서비스는 클러스터 IP 또는 서비스 이름을 사용하여 다른 파드에 의해 접근될 수 있습니다. 🌐